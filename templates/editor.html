{% extends "base.html" %}

{% block css %}
<link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/editor.css' ) }}">
{% endblock %}


{% block body %}
<div class="center-block">
  <div class="card">
    <form action='/widget/new/text' method='POST'>
      <input type='text' name='text' />
      <input type='submit' />
    </form>

    <form action='/widget'>
      <input type='text' name='widget_id' />
      <input type='submit' />
    </form>

    <div id="demo" class="row">
      <div class="col">
	<h3>Available Widgets</h3>
	<div id="widgets" class="list-group">
          <div id="widget-text" data-id="widget-text" class="list-group-item nested-1">Text Widget</div>
          <div id="widget-text_input" data-id="widget-text_input" class="list-group-item nested-1">Text Input Widget</div>
          <div id="widget-choice" data-id="widget-choice" class="list-group-item nested-1">Choice Widget</div>
          <div id="widget-image" data-id="widget-image" class="list-group-item nested-1">Image Widget</div>
	</div>
      </div>
      
      <div class="col">
	<h3>Game Timeline</h3>
	<div id="timeline" class="list-group">
	</div>
      </div>
    </div>
    <button id="get-order" >Get Order</button>

  </div>
</div>

{% endblock %}

{% block js %}
<script src="https://unpkg.com/sortablejs-make/Sortable.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/jquery-sortablejs@latest/jquery-sortable.js"></script>
<script>
  // List 1
  $('#widgets').sortable({
      group: {
          name: 'shared',
          pull: 'clone', // To clone: set pull to 'clone'
	  put: false
      },
      animation: 200,
      ghostClass: 'ghost',
      sort: false
  });

  // List 2
  $('#timeline').sortable({
      group: 'shared',
      animation: 200,
      ghostClass: 'ghost',
      onSort: reportActivity
  });

  var widget_id = 0;

  function get_timeline() {
      let arr = [];
      
      for (elem of $('#timeline')[0].children)
	  arr.push(elem.id);

      return arr;
  }

  $('#get-order').click(function() {
      console.log(get_timeline())
  });

  // Report when the sort order has changed
  function reportActivity(e) {
      if (e.pullMode == 'clone') {
	  console.log(e);
	  e.item.id += '-' + widget_id;
	  widget_id++;
      }
  };
</script>
{% endblock %}
